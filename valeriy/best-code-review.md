# идеальный код-ревью

## Представление участников

 * пара слов об опыте и увлечениях, основном смысле и канве профессионального развития, с заходом в релевантные хобби.
 * Т.е это представление не личности участников, но больше сути их точек зрения, пояснение откуда растёт их аргументация
 * Пример: привет, меня зовут Валера, работаю в ИТ и около более 20 лет включая четыре большие вехи: менеджмент, инфраструктура, архитектура и разработка в кровавом энтерпрайзе.
 * Все эти годы у меня был и остаётся в фокусе научный подход к организации труда, автоматизация процессов, из самого свежего - анализ качества кода больших проектов.
 * По этим темам написаны несколько статей и утилит с открытым исходным кодом.

## введение

 * Начнём с темы и её актуальности.
 * Тема дискуссии - процессы код-ревью, проверки кода.
 * Актуальность её по-умолчанию достаточно высока: это один из базовых и самых распространённых процессов почти во всех проектах разработки ПО.
 * Однако в нашу эпоху перемен большинство проектов испытывают болезненный процесс изменений. Во всём мире происходит масштабное изменение численности наёмных сотрудников, они меняют не только проекты, но и компании, страны, сферы деятельности. Многие вынуждены уйти или войти в область ИТ, т.е. идёт активная борьба между хаосом и порядком, в том числе, и в процессах.
 * Болезненность изменений, и следующей за ними массовой миграцией специалистов подстёгивает ажиотаж и реклама вокруг нового класса инструментов поддержки принятия решения - нейросетей. На текущем этапе они формируют [возрастающее давление](https://futureoflife.org/open-letter/pause-giant-ai-experiments/) на рынок труда.
 * Однако время перемен - это время возможностей. Зерно здравого смысла имеет больше шансов взойти именно сейчас.
 * Ранее уже были несколько дискуссий, и огромное количество статей как по поводу процессов вообще, так и по поводу код-ревью. Общее место - это недовольство процессами, усугубляющееся в эпоху перемен, когда зачастую нужен ещё более значимый результат за ещё более сжатые сроки.
 * Итак, у нас на столе обсуждения лежит процесс код-ревью, как актуальный, животрепещущий и один из самых распространённых процессов в разработке ПО.

## постановка проблемы

 * Есть [книги](https://www.litres.ru/book/stiv-makkonnell/professionalnaya-razrabotka-programmnogo-obespecheniya-24499934/) и [исследования](https://www.michaelagreiler.com/code-review-blog-post-series/) проблемы процессов в ИТ, в сообществе есть консенсус о том, что процессы в подавляющем большинстве проектов нуждаются в улучшении. Проще говоря, недовольных процессами разработчиков гораздо больше, чем удовлетворённых.
 * Зачастую те или иные процессы внедряются по-привычке, то есть формально. А с учётом сложной и усложняющейся с каждым днём обстановки в наших проектах, качество процессов так или иначе деградирует в угоду иллюзии скорости.
 * Из прошедших ранее дискуссий, мы возьмём и выложим на стол обсуждения следующие области, обозначив их как канву дискуссии:
	* [канва №1](https://www.youtube.com/watch?v=eYdS8gCtasY). Форма: нам бы побыстрее. Вред и польза регулярности/обязательности процесса код-ревью.
	* [Канва №2](https://www.youtube.com/watch?v=XDF02KmgJFE&list=PLm6zCN_KJCrX81iojL2lE2gHSbwnQE-QI&t=1560s). Суть: нам бы попроще. Вред и польза жадных алгоритмов в настройке процессов. Типичный процесс внедряется формально, по привычке, и не растягивается до бизнес-целей или целей команды. Отсюда понятно почему он бесполезен либо вреден - никто его не дорабатывает под конкретный проект и людей. Потому что непонятно для чего он внедрялся. Видео про производство фич, но можно вместо фичи подставить процесс код ревью, и прожевать в этом ракурсе.
	* [Канва №3](https://www.youtube.com/watch?v=p2b4JHESEOc). Резюме: а что делать. Вред и польза код-ревью на разных стадиях зрелости процессов. Если уж дойдёт дискуссия до "что делать", можно посмотреть на три стадии оптимизации, вот тут [текстовая версия](https://habr.com/ru/companies/jugru/articles/338732/).

## о чём будет идти речь

 * Здесь мы договариваемся на берегу об ограничениях и направлениях нашей дискуссии.
 * Первое - это формат: дискуссия с разными точками зрения.
 * Дискуссия потому что она позволяет максимально быстро и просто накидывать аргументы. У нас, к сожалению, утрачена культура дискуссий как двигателя прогресса. Статьи, зачастую, пишутся мертворождёнными, описывая исключительные случаи.
 * Разность точек зрения вводится для того, чтобы сократить и упростить аргументы, морально подстегнуть авторов отстаивать свою позицию.
 * Предмет дискуссии: регулярность, простота и способы настройки процесса код-ревью
 * Результат дискуссии: списки, графики, таблицы. Чем проще/короче, тем лучше.
 * В типичный код-ревью входят проверки на соответствие формализованным/объективным и не очень/субъективным требованиям к коду:
 	* форма: стиль/подход/читаемость/структура/модифицируемость
	* суть: логика/покрытие/ошибки/оптимизации/охват/объём
 * Бизнес-цели типичного код-ревью:
	* тратить меньше денег/времени на исправление ошибок
	* дешевле/быстрее обучать коду проекта и проектным практикам
	* снизить потребность в код-ревью каждой задачи и/или проекта в целом
 * Проблемы типичного код-ревью:
	* дорого за счёт привлечения нескольких разработчиков к одной и той же задаче
	* ущерб срокам: синхронность/прерывание смежных процессов
	* ущерб мотивации: субъективность, эмоциональность
	* неэффективность: избыточность затрачиваемых усилий по отношению к выгоде
 * Типичное решение типичных проблем код-ревью:
	* разбиение на этапы
	* замена ручной проверки автоматизацией
	* автоматизация проверки качества кода проекта в целом
	* повышение качества кода через обучение
	* формализация
	* ограничение по времени/охвату/участникам
	* облегчение труда программиста, упрощение создания кода

## канва №1. Форма: нам бы побыстрее

 * на поверхности я вижу желание упорядочить расписание синхронных задач, т.е. планирование активности по времени - это отложенная дискуссия по сути. Мы же не любим прерываться и выходить из потока? Хотя некоторые патриархи категорически против состояния потока, и менеджеры им люто аплодируют.
 * регулярное код-ревью есть у всех, всем понятно, и у бизнеса нет вопросов. По теме пользы есть вагон и маленькая тележка статей/книг/тренингов/докладов. А вот про вред маловато будет
 * как понять, что код-ревью уже можно делать реже и проще, что часть текущих проблем решена?
 * когда можно заменить регулярные интервалы на случайные?
 * какой интервал лучше: день/неделя/месяц?
 * когда можно заменить регулярные временные интервалы на объёмы кода: через сколько строк кода?
 * как меняется полезность код-ревью в зависимости не только от частоты проверок, но и от зрелости процессов/людей/кода?
 * стоимость ошибки на разных этапах выполнения задачи. Сколько и каких ошибок мы можем пропустить, чтобы сохранить жизнеспособность/рентабельность проекта?
 * какова вероятность ошибки на разных этапах выполнения задачи, а если умножить на стоимость?

## канва №2. Суть: нам бы попроще

 * главное препятствие - деньги. У эффективных менеджереров есть математический аналог - жадные алгоритмы. На каждом шаге только наиболее выгодные решения из доступных. Работать вдолгую могут себе позволить немногие.
 * Постулируем, что процесс код-ревью сам по себе нужен, вопрос как, кем, когда и чем его готовить - например, в виде парного программирования. Или если его не делать, то чем заменить. Не у всех есть толпа девопсов/архитекторов/лидов, которые мгновенно и бесплатно делают некачественный код невозможным.
 * сколько стоит настроить процесс в ту или другую сторону? - умножаем вероятность ошибки на её стоимость, которая растёт от начала к концу выполнения задачи
 * чем заменить фобию "тасочки должны двигаться": торопимся двинуть тасочку, перекладываем ответственность на следующий этап или специалиста
 * работа с ожиданиями: большинство лучших практик кажутся немыслимыми в большинстве проектов
 * когда можно заменить полный охват проверок на случайный?
 * время окупаемости различных подходов к решению проблем код-ревью
 * необходимость и достаточность процесса ручной проверки кода
 * что полезнее или вреднее: устранять последствия плохого процесса или настраивать хороший?
 * самый простой и убедительный способ выбора между простыми и сложными решениями? Картинки, таблички, цитаты, формулы?
 * что дешевле - проверять код вручную или автоматизация проверки?
 * что дешевле - проверять/переделывать или научиться писать сразу хорошо?
 * насколько просто/дёшево внедрить предварительный процесс проектирования или эскизного решения задач? Т.е. ускоряет/удешевляет ли введение промежуточных этапов проверки?
 * можно ли настроить процесс без длительного обучения или дорогого консалтинга?
 * если совсем некогда оптимизировать, искать подходящий формат, то получаем все недостатки в полном объёме
 * один из признаков большего вреда, чем пользы: нам проще воспитать джуна, чем нанять синьора. Т.е. процессы вызывают оттордение у состоявшихся специалистов, у нет гибкости и простоты.

## канва№3. Резюме: что делать

 * отражение карго-культа: мы доверяем только признанным специалистам с безупречной репутацией, не проверяя мозгом/проектом их тезисы
 * типовые проектные решения - где взять и как дорого/сложно доработать?
 * главный вопрос - понимать зачем процесс нужен, тогда можно подстроить его форму под задачу и ограничения, которые тоже нужно осознать
 * беда, как водится, растет из недостатка денег и общей неустроенности жизни людей. Деградация этого фундамента выводится за скобки или сублимируется печеньками/корпоративами. Например, основа основ - здоровый сон. До этого вообще никому дела нет. И подступиться к этой проблеме ужас как сложно.
 * Как выход, например - читать классиков типа Мартина, набирать цитаты, которыми укреплять свою переговорную позицию. Более крутой выход - гильдии уровня выше корпораций, которые пишут те самые надкорпоративные стандарты.
 * как понять насколько простые решения можно здесь и сейчас реализовывать, и как идти мелкими шагами вперёд, не сбиваясь с пути?
 * непонятно как вообще такой стандартный и простой процесс, например, код ревью, можно настроить - что в нём менять-то, там менять нечего.
 * зачастую, от код ревью больше боли, чем пользы. Я встречал многонедельные ревью, и причин тому может быть много.
 *

## открытый микрофон

 * Я про код-ревью слишком много могу рассказать. Тк для меня это способ найти зацепку, пример, на котором пойти человеку что-нибудь рассказывать. Когда прошу других посмотреть, то я тестирую их, смотрю что они находят. Что поняли, а что нет. В то же время для человека это способ уложить знания, объяснить другому. На моих код-ревью не канают отписки и мелкие комментарии. Учу формулировать мысли. И, конечно, контроль качества. И это только первая ступень. Когда материал набирается, то пишется небольшая статья, либо 1на1 подхожу в офисе поболтать и порассказывать что-то. Плюс я ввел практику "код ревью онлайн". Где мы сидим с ребятами и я ревьювлю, шарю экран и подробно комментирую всё. Не редко бывает что дискуссия уходит на полтора часа, хотя кода там было строк на 20, потому что программировать это не мешки ворочать
 * разработчики многие делают это по привычке - у всех есть и нам надо. Не сильно сопоставляя, что заявленные проблемы ревью решает не так уж и хорошо. Обычно декларируют уменьшение багов, повышение качества кода, обмен знаниями, обучение. Ничего из этого толком не исполняется, а до кучи получаем точку демотивации, когда разработчику говорят, что всё это хрень и надо переделывать, потому сто ты ошибся в самом начале в том-то и том-то. Код ревью полезно точечное, когда ты привлекаешь не на всю задачу, а на отдельный фрагмент кода, что ты правильно понял какой-то нюанс или сомневаешься в чем-то. Но это можно и просто в пару сесть и вместе посмотреть, тут уже зависит от того в одной ли вы команде и насколько далеки часовые пояса.
 * У меня код ревью чуть менее чем каждый день и основная задача - исправлять баги в головах, а не коде. Потому что именно головы рождают код. Я и мой коллега как правило по итогам крупных задач пишем материалы внутри компании. Несем знания в массы. Одновременно ревьювлю человек 5-7, плюс иногда приходят с вопросами из других команд. За всю историю помню три крутых момента. В двух из них люди меня благодарили за то что я для них сделал (честно, в тот момент не ожидал). И третий это когда меня спросили "Где почитать о том что ты рассказываешь? Мне надо для курсовой источник указать"


